!function(e){var t={};function r(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,r),l.l=!0,l.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(o,l,function(t){return e[t]}.bind(null,l));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){window.onload=function(){l=document.getElementById("canvas"),o=l.getContext("2d"),n=l.width/10,void 0===localStorage._scoreResetSept2018&&(localStorage._hscore=a=0,localStorage._scoreResetSept2018=!0),function(){clearInterval(e),clearInterval(t);try{document.removeEventListener("keydown",K),document.removeEventListener("keyup",K),document.removeEventListener("mousedown",J)}catch(e){console.error(e)}!0,document.addEventListener("keydown",K),document.addEventListener("keyup",K),document.addEventListener("mousedown",J);try{u=JSON.parse(localStorage._end)}catch(e){console.error(e),u=!1}try{!function(){try{if(u)return a=JSON.parse(localStorage._hscore),i=k(l.width/n,l.height/n).slice(0),R(),void(u=!1)}catch(e){console.error(e),a=0}try{null!=localStorage._arena&&"undefined"!=localStorage._arena&&(i=JSON.parse(localStorage._arena))}catch(e){console.error(e)}finally{null==i&&(i=k(l.width/n,l.height/n))}try{null==localStorage._hscore||"undefined"==localStorage._hscore?highScore=localStorage._hscore=0:highScore=JSON.parse(localStorage._hscore),c=null==localStorage._score||"undefined"==localStorage._score?localStorage._score=0:JSON.parse(localStorage._score),I=JSON.parse(localStorage._player)}catch(e){console.error(e)}}()}catch(e){console.error(e)}(s=new Image).src="../images/restart.png",(f=new Image).src="../images/pause.png";var e=setInterval(B,1e3/p),t=setInterval(G,1e3/S);null==I&&R();requestAnimationFrame(O)}()};const r=[null,"#FF0D72","#0DC2FF","#0DFF72","#F538FF","#FF8E0D","#FFE138","#3877FF"];shapes=[[[1,1,1],[0,1,0],[0,0,0]],[[2,2],[2,2]],[[0,0,3,0],[0,0,3,0],[0,0,3,0],[0,0,3,0]],[[0,4,0],[0,4,0],[0,4,4]],[[0,5,0],[0,5,0],[5,5,0]],[[0,6,6],[6,6,0],[0,0,0]],[[7,7,0],[0,7,7],[0,0,0]]],speed=7;let o,l,n,i,a,s,f,h,c=0,u=!1,g={x:0,y:0},d=!1,y=!1,S=12,p=20,x=1,v=0;let m=0,w=0,_=0,b=50*speed;function O(e=0){if(u&&function(){let e="You hit the limit!",t=.05*n;o.font=n+"px Arial",o.fillStyle="#ff5b5b",o.fillText(e,l.width/2-o.measureText(e).width/2+t,8*n+t);let r="Press any key to restart";o.font=.7*n+"px Arial",o.fillStyle="#ff5b5b",o.fillText(r,l.width/2-o.measureText(r).width/2+t,9*n+t),o.font=n+"px Arial",o.fillStyle="red",o.fillText(e,l.width/2-o.measureText(e).width/2,8*n),o.font=.7*n+"px Arial",o.fillStyle="red",o.fillText(r,l.width/2-o.measureText(r).width/2,9*n)}(),o.fillStyle="black",o.fillRect(0,0,l.width,l.height),o.fillStyle="red",o.fillRect(0,3*n-x,l.width,x),F(i,{x:0,y:0}),F(I.shape,{x:I.x,y:I.y}),T(),m=e-w,w=e,(_+=m)>b&&!u&&!y&&(M(),_=0),null==a)try{a=localStorage._hscore}catch(e){console.error(e)}null==a&&(a=0),o.font=2*n+"px Arial",o.fillStyle="#fff",o.fillText(c,l.width/2-o.measureText(c).width/2,2.5*n),o.font=.5*n+"px Arial",o.fillStyle="#fff",o.fillText("High score: "+a,l.width/2-o.measureText("High score: "+a).width/2,3.5*n),function(){this.offset=1,this.hoverSize=n/5,g.x>n*this.offset-this.hoverSize&&g.x<n*this.offset+n+2*this.hoverSize&&g.y>n*this.offset-this.hoverSize&&g.y<n*this.offset+n+2*this.hoverSize?(d=!0,o.fillStyle="#3a3a3a",o.fillRect(n*this.offset-this.hoverSize,n*this.offset-this.hoverSize,n+2*this.hoverSize,n+2*this.hoverSize)):d=!1;o.drawImage(s,n*this.offset,n*this.offset,n,n)}(),function(){this.offsetX=8,this.offsetY=1,this.hoverSize=n/5,g.x>n*this.offsetX-this.hoverSize&&g.x<n*this.offsetX+n+offsetX&&g.y>n*this.offsetY-this.hoverSize&&g.y<n*this.offsetY+n+offsetY?(h=!0,o.fillStyle="#3a3a3a",o.fillRect(n*this.offsetX-this.hoverSize,n*this.offsetY-this.hoverSize,n+2*this.hoverSize,n+2*this.hoverSize)):h=!1;o.drawImage(f,n*this.offsetX,n*this.offsetY,n,n)}(),function(){for(let e=i.length-1;e>=0;e--)i[e].every(e=>e>0)&&(i.splice(e,1),i.splice(0,0,new Array(i[1].length).fill(0)),c+=v,v*=2)}(),requestAnimationFrame(O)}function k(e,t){let r=[];for(;t--;)r.push(new Array(e).fill(0));return r}function F(e,t){for(let l=0;l<e.length;l++)for(let i=0;i<e[l].length;i++)0!==e[l][i]&&(o.fillStyle=r[e[l][i]],o.fillRect((t.x+i)*n,(t.y+l)*n,n,n))}function z(e,t){for(let t=0;t<e.length;++t)for(let r=0;r<t;++r)[e[r][t],e[t][r]]=[e[t][r],e[r][t]];t>0?e.forEach(e=>e.reverse()):e.reverse()}function T(){try{c>a&&(a=c,localStorage._hscore=JSON.stringify(a)),localStorage._end=JSON.stringify(u),localStorage._score=JSON.stringify(c),localStorage._arena=JSON.stringify(i),localStorage._player=JSON.stringify(I)}catch(e){}}function J(e){d?C(!0):h&&(y=!y)}var N=1,E=10,A=75,I={start_x:5,x:5,y:0,shape:[]};function j(){let e=I.shape;for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)if(0!==e[t][r]&&i[I.y+t]&&0!==i[I.y+t][I.x+r])return!0;return!1}function M(){if(_=0,I.y+I.shape.length-1-L(I.shape)<0&&(I.x=I.start_x),I.x+I.shape.length-1-P(I.shape)>i[0].length-1&&(I.x=i[0].length-I.shape.length+P(I.shape)),I.x+X(I.shape)<0&&(I.x=0-X(I.shape)),I.y++,j()||I.y>i.length-I.shape.length+L(I.shape)){if(c+=E,I.y--,function(e,t){const r=e.shape;for(let o=0;o<r.length;o++)for(let l=0;l<r.length;l++)if(r[o][l]&&0!==r[o][l])try{t[e.y+o][e.x+l]=r[o][l]}catch(e){console.error(e)}}(I,i),function(e){let t=0;return e.forEach(e=>{t+=e}),t}(i[2])>0)return F(i,{x:0,y:0}),u=!0,void C(!1);R()}}function R(){I.shape=shapes[Math.round(Math.random()*(shapes.length-1))],I.y=-I.shape.length+L(I.shape),I.x=5-Math.round(I.shape.length/2),I.start_x=I.x,v=A}function Y(e){const t=I.x;let r=1;for(z(I.shape,e);j();)if(I.x+=r,(r=-(r+(r>0?1:-1)))>I.shape[0].length)return z(I.shape,-e),void(I.x=t)}function L(e){let t=0;for(let r=e.length-1;r>=0;r--){for(let o=0;o<e[r].length;o++)if(0!==e[r][o])return t;t++}return t}function P(e){let t=0;for(let r=e.length-1;r>=0;r--){for(let o=0;o<e.length;o++)if(0!==e[o][r])return t;t++}return t}function X(e){let t=0;for(let r=0;r<e.length;r++){for(let o=0;o<e.length;o++)if(0!==e[o][r])return t;t++}return t}function C(e){D=q=H=!1,T(),u=!0,localStorage._end=JSON.stringify(u),localStorage._arena=JSON.stringify(k(l.width/n,l.height/n).slice(0)),e&&location.reload()}var D=!1,q=!1,H=!1;function B(){q&&(c+=N,M())}function G(){D?(I.x--,j()&&I.x++):H&&(I.x++,j()&&I.x--)}function K(e){if(u)C(!0);else{if(y)return;if("keydown"==e.type)switch(e.keyCode){case 87:case 38:Y(1);break;case 65:case 37:if(I.y+I.shape.length-L(I.shape)<0)break;D=!0;break;case 83:case 40:q=!0;break;case 68:case 39:if(I.y+I.shape.length-L(I.shape)<0)break;H=!0}else if("keyup"==e.type)switch(e.keyCode){case 65:case 37:D=!1;break;case 83:case 40:q=!1;break;case 68:case 39:H=!1}}}}]);